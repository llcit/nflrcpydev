{% extends "wrap-content.html" %}
{% load staticfiles %}



{% block pageheading %}
<h2 class="l2_crumbs">	
	<a href="/publications" class="badge_publications">Publications</a>
	{% if subpage %}:	<span class="badge badge_publications_fill">{{ items|length }}</span> 
				{{ subpage|title }}
			{% endif %} 
</h2>
{% endblock pageheading %}

{% block subheadlines %}
<div class="submenu"> 
	<ul>		
		<li><div class="buttonbox {% if subpage == 'journals' %}buttonbox_highlighted{% endif %}"><a href="journals">Journals </a></div></li>
		<li><div class="buttonbox {% if subpage == 'monographs' %}buttonbox_highlighted{% endif %}"><a href="monographs">Monographs</a></div></li>
		<li><div class="buttonbox {% if subpage == 'teaching-materials' %}buttonbox_highlighted{% endif %}"><a href="teaching-materials">Materials</a></div></li>
		<li><div class="buttonbox {% if subpage == 'pragmatics' %}buttonbox_highlighted{% endif %}"><a href="pragmatics">Pragmatics </a></div></li>
		<li><div class="buttonbox {% if subpage == 'digital-archives' %}buttonbox_highlighted{% endif %}"><a href="digital-archives"> Archives </a></div></li>
		<li><div class="buttonbox {% if subpage == 'media' %}buttonbox_highlighted{% endif %}"><a href="media">Media </a></div></li>
		<li><div class="buttonbox {% if subpage == 'listing' %}buttonbox_highlighted{% endif %}"><a href="listing">Full List </a></div></li>
	</ul>	
</div>
{% endblock subheadlines %}



{% block stories %}
{% if subpage|title != "Listing" %}

	<div id="dyno" class="container">
		{% for p in items %}

			<a href="{{ p.get_absolute_url }}">
			<div class="listing shadowboxed">
				<p> <img src="{{MEDIA_URL}}img/{{ p.image }}"> </p>
				<h4>{{ p.title | safe | truncatewords:8 }}</h4>
				<h5>{{ p.thumbnail_desc | safe | truncatewords_html:140 }}</h5>
				<p><span class="badge_container badge_{{ p.classname }}"> {{ p.displayname }} <small>({{ subpage }})</small> </span> </p>
			</div>
			</a>
			
		{% endfor %}
	</div>

{% else %} <!-- FULL LIST WITH NO ICONS -->

	<div class="container">
	{% for p in items %}
		{% ifchanged p.category %} <div class="row"><h3><small>{{ p.category }}</small> </h3></div> {% endifchanged %}
		<div class="row enchilada {% cycle 'shade' 'noshade' %}">
			<a href="{{ p.get_absolute_url }}">
			<div class="col-md-1">
				{{ p.year }}
			</div>
			<div class="col-md-3">
				{{ p.title | safe }}
			</div>
			<div class="col-md-8">
				{{ p.thumbnail_desc | safe | truncatewords_html:140 }}
			</div>
			</a>
		</div>
	{% endfor %}
	</div>

{% endif %}
{% endblock stories %}


{% block customjavascript %}

jQuery(window).on('load', function(){ 
	var $ = jQuery;
	var container = document.querySelector('#dyno');
	var msnry = new Masonry( container, {
	  // options
	  columnWidth: 230,
	  itemSelector: '.listing',
	  gutter: 40,
	  isFitWidth: 'true'
	});
})
{% endblock customjavascript %}

